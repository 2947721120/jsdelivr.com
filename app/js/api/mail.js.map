{"version":3,"file":"mail.js","sources":["../.gobble-build/13-include/1/js/api/mail.js"],"sourcesContent":["import mailer from 'nodemailer';\nimport logger from '../logger';\n\nlet appLog = logger('app');\nlet config = Object.create(null);\n\nconfig['custom-cdn'] = {\n\temail: 'contact@jsdelivr.com',\n\tsubject: 'Custom CDN Hosting',\n};\n\nconfig['consultation-services'] = {\n\temail: 'dakulovgr@gmail.com',\n\tsubject: 'jsDelivr: Consultation services',\n};\n\nexport default function (req, res) {\n\tif (!(req.body.page in config) || !req.body.name || !req.body.email || !req.body.message || !/^[^@]+@[^@]+\\.[^@]+$/.test(req.body.email)) {\n\t\treturn res.sendStatus(400);\n\t}\n\n\tlet transporter = mailer.createTransport();\n\n\ttransporter.sendMail({\n\t\tfrom: req.body.email,\n\t\tto: config[req.body.page].email,\n\t\tsubject: config[req.body.page].subject,\n\t\ttext: `Name:\\n${req.body.name}\\n\\nMessage:\\n${req.body.message}`,\n\t}, function (error) {\n\t\tlet email = JSON.stringify({ name: req.body.name, email: req.body.email, message: req.body.message });\n\n\t\tif (error) {\n\t\t\tappLog.err(`Failed to send email: ${email}`);\n\t\t\tappLog.err(error);\n\t\t\treturn res.send(500);\n\t\t}\n\n\t\tappLog.info(`Sent email: ${email}`);\n\t\treturn res.send(200);\n\t});\n}\n"],"names":[],"mappings":";;;;;;;;0BAAmB,YAAY;;;;sBACZ,WAAW;;;;AAE9B,IAAI,MAAM,GAAG,yBAAO,KAAK,CAAC,CAAC;AAC3B,IAAI,MAAM,GAAG,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;;AAEjC,MAAM,CAAC,YAAY,CAAC,GAAG;AACtB,MAAK,EAAE,sBAAsB;AAC7B,QAAO,EAAE,oBAAoB;CAC7B,CAAC;;AAEF,MAAM,CAAC,uBAAuB,CAAC,GAAG;AACjC,MAAK,EAAE,qBAAqB;AAC5B,QAAO,EAAE,iCAAiC;CAC1C,CAAC;;qBAEa,UAAU,GAAG,EAAE,GAAG,EAAE;AAClC,KAAI,EAAE,GAAG,CAAC,IAAI,CAAC,IAAI,IAAI,MAAM,CAAA,AAAC,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,KAAK,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,OAAO,IAAI,CAAC,sBAAsB,CAAC,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,KAAK,CAAC,EAAE;AACzI,SAAO,GAAG,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC;EAC3B;;AAED,KAAI,WAAW,GAAG,wBAAO,eAAe,EAAE,CAAC;;AAE3C,YAAW,CAAC,QAAQ,CAAC;AACpB,MAAI,EAAE,GAAG,CAAC,IAAI,CAAC,KAAK;AACpB,IAAE,EAAE,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,KAAK;AAC/B,SAAO,EAAE,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,OAAO;AACtC,MAAI,cAAY,GAAG,CAAC,IAAI,CAAC,IAAI,sBAAiB,GAAG,CAAC,IAAI,CAAC,OAAO,AAAE;EAChE,EAAE,UAAU,KAAK,EAAE;AACnB,MAAI,KAAK,GAAG,IAAI,CAAC,SAAS,CAAC,EAAE,IAAI,EAAE,GAAG,CAAC,IAAI,CAAC,IAAI,EAAE,KAAK,EAAE,GAAG,CAAC,IAAI,CAAC,KAAK,EAAE,OAAO,EAAE,GAAG,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC,CAAC;;AAEtG,MAAI,KAAK,EAAE;AACV,SAAM,CAAC,GAAG,4BAA0B,KAAK,CAAG,CAAC;AAC7C,SAAM,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;AAClB,UAAO,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;GACrB;;AAED,QAAM,CAAC,IAAI,kBAAgB,KAAK,CAAG,CAAC;AACpC,SAAO,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;EACrB,CAAC,CAAC;CACH"}