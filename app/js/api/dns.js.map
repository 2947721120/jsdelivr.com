{"version":3,"file":"dns.js","sources":["../.gobble-build/13-include/1/js/api/dns.js"],"sourcesContent":["import dns from 'native-dns';\nimport logger from '../logger';\n\nlet appLog = logger('app');\nlet server = { address: '127.0.0.1:51792/www.jsdelivr.com/src/' };\n\ndns.lookup(server.address, (error, address) => {\n\tif (error) {\n\t\tthrow error;\n\t}\n\n\tserver.address = address;\n\tappLog.info(`DNS server address: ${address}.`);\n});\n\nexport default function (req, res) {\n\tif (!req.query.domain) {\n\t\treturn res.sendStatus(400);\n\t}\n\n\tlet request = dns.Request({\n\t\tquestion: dns.Question({\n\t\t\tname: req.query.domain,\n\t\t\ttype: 'A',\n\t\t}),\n\t\tserver: server,\n\t});\n\n\trequest.on('timeout', () => {\n\t\tres.sendStatus(540);\n\t});\n\n\trequest.on('message', (error, response) => {\n\t\tif (error || !response.answer.length) {\n\t\t\treturn res.sendStatus(500);\n\t\t}\n\n\t\tres.send(response.answer[0].data);\n\t});\n\n\trequest.send();\n}\n"],"names":[],"mappings":";;;;;;;;yBAAgB,YAAY;;;;sBACT,WAAW;;;;AAE9B,IAAI,MAAM,GAAG,yBAAO,KAAK,CAAC,CAAC;AAC3B,IAAI,MAAM,GAAG,EAAE,OAAO,EAAE,uCAAuC,EAAE,CAAC;;AAElE,uBAAI,MAAM,CAAC,MAAM,CAAC,OAAO,EAAE,UAAC,KAAK,EAAE,OAAO,EAAK;AAC9C,KAAI,KAAK,EAAE;AACV,QAAM,KAAK,CAAC;EACZ;;AAED,OAAM,CAAC,OAAO,GAAG,OAAO,CAAC;AACzB,OAAM,CAAC,IAAI,0BAAwB,OAAO,OAAI,CAAC;CAC/C,CAAC,CAAC;;qBAEY,UAAU,GAAG,EAAE,GAAG,EAAE;AAClC,KAAI,CAAC,GAAG,CAAC,KAAK,CAAC,MAAM,EAAE;AACtB,SAAO,GAAG,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC;EAC3B;;AAED,KAAI,OAAO,GAAG,uBAAI,OAAO,CAAC;AACzB,UAAQ,EAAE,uBAAI,QAAQ,CAAC;AACtB,OAAI,EAAE,GAAG,CAAC,KAAK,CAAC,MAAM;AACtB,OAAI,EAAE,GAAG;GACT,CAAC;AACF,QAAM,EAAE,MAAM;EACd,CAAC,CAAC;;AAEH,QAAO,CAAC,EAAE,CAAC,SAAS,EAAE,YAAM;AAC3B,KAAG,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC;EACpB,CAAC,CAAC;;AAEH,QAAO,CAAC,EAAE,CAAC,SAAS,EAAE,UAAC,KAAK,EAAE,QAAQ,EAAK;AAC1C,MAAI,KAAK,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,MAAM,EAAE;AACrC,UAAO,GAAG,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC;GAC3B;;AAED,KAAG,CAAC,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC;EAClC,CAAC,CAAC;;AAEH,QAAO,CAAC,IAAI,EAAE,CAAC;CACf"}